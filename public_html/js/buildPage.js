'use strict';define(function(){var a=function(b,c){_.isUndefined(b)&&(b=_.findWhere(app.site.pages,{href:'/'})),Promise.all([fetch(b.source).then(function(a){return a.text()}).then(function(a){return app.mdConverter.makeHtml(a)}),app.loadExtTemplate(b.type)]).then(function(d){app.container.html(app.rootTemplate(Object.assign({main:d[1](Object.assign({main:Handlebars.compile(d[0])()},b)),navbar:_.filter(app.site.pages,function(a){return _.contains(app.site.navlinks,a.href)}),posts:_.sortBy(_.filter(app.site.pages,function(a){return!_.isUndefined(a.date)}),function(a){return moment(a.date).toDate().getTime()}).reverse().splice(0,5)},app.site))),$('a').click(function(b){var c=$(b.currentTarget);c.attr('href').startsWith('#/')&&(b.preventDefault(),app.toggleSpinner(!0),a(_.findWhere(app.site.pages,{href:c.attr('href').substring(1)}),!0))}),c&&window.history.pushState({},document.title,'#'+b.href),app.plugins.forEach(function(a){a.render()}),app.toggleSpinner(!1)})};return a});